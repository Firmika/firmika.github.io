# 数论

## 类欧几里得算法

### 基本思想

设
$$
f(a,b,c,n)=\sum_{i=0}^{n}{\left\lfloor\frac{ai+b}{c}\right\rfloor}
$$
其中$a,b,c,d$是常数，$a\geq0$且$c\geq0$，需要一个$O(logn)$的算法。

分式向下取整的形式和数论分块很像，但思想不太一样。

递推式如下：

$$
\begin{align*}
f(a,b,c,n)=\begin{cases}
\frac{n(n+1)}{2}\left\lfloor\frac{a}{c}\right\rfloor+(n+1)\left\lfloor\frac{b}{c}\right\rfloor+f(a\bmod c,b\bmod c,c,n) & a\geq c且b\geq c\\
\phantom {\frac{n(n+1}{2}}mn-f(c,c-b-1,a,m-1) & a<c且b<c
\end{cases}
\end{align*}
$$
其中$m=\left\lfloor\frac{an+b}{c}\right\rfloor$.

### 证明

采用了**贡献合并计算**的思想，将贡献与条件做转化变成了其它形式。

详参[oi-wiki的证明](https://oi-wiki.org/math/number-theory/euclidean/).